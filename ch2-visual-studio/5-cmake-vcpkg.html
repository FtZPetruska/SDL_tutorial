<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Using VCPKG with CMake - SDL Tutorial</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Introduction</a></li><li class="chapter-item expanded "><a href="../ch1-cmake-vcpkg/index.html"><strong aria-hidden="true">1.</strong> CMake, VCPKG and VSCode: the silver bullet</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../ch1-cmake-vcpkg/1-installation/1-introduction.html"><strong aria-hidden="true">1.1.</strong> Installation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../ch1-cmake-vcpkg/1-installation/2-windows.html"><strong aria-hidden="true">1.1.1.</strong> Windows</a></li><li class="chapter-item expanded "><a href="../ch1-cmake-vcpkg/1-installation/3-macos.html"><strong aria-hidden="true">1.1.2.</strong> macOS</a></li><li class="chapter-item expanded "><a href="../ch1-cmake-vcpkg/1-installation/4-linux.html"><strong aria-hidden="true">1.1.3.</strong> Linux</a></li></ol></li><li class="chapter-item expanded "><a href="../ch1-cmake-vcpkg/2-configuring-vscode.html"><strong aria-hidden="true">1.2.</strong> Configuring vscode</a></li><li class="chapter-item expanded "><a href="../ch1-cmake-vcpkg/3-sdl2-install.html"><strong aria-hidden="true">1.3.</strong> Installing packages with VCPKG</a></li><li class="chapter-item expanded "><a href="../ch1-cmake-vcpkg/4-cmakelists.html"><strong aria-hidden="true">1.4.</strong> Writing a CMakeLists</a></li></ol></li><li class="chapter-item expanded "><a href="../ch2-visual-studio/1-introduction.html"><strong aria-hidden="true">2.</strong> Visual Studio</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../ch2-visual-studio/2-installation.html"><strong aria-hidden="true">2.1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../ch2-visual-studio/3-msbuild-manual.html"><strong aria-hidden="true">2.2.</strong> Manual dependency management</a></li><li class="chapter-item expanded "><a href="../ch2-visual-studio/4-msbuild-vcpkg.html"><strong aria-hidden="true">2.3.</strong> Using VCPKG with MSBuild</a></li><li class="chapter-item expanded "><a href="../ch2-visual-studio/5-cmake-vcpkg.html" class="active"><strong aria-hidden="true">2.4.</strong> Using VCPKG with CMake</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">SDL Tutorial</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="vs-cmake-project-with-vcpkg"><a class="header" href="#vs-cmake-project-with-vcpkg">VS CMake Project with VCPKG</a></h1>
<p>In this section, we will cover how to install and use VCPKG to download all the libraries for CMake project inside Visual Studio.</p>
<h2 id="installing-vcpkg"><a class="header" href="#installing-vcpkg">Installing VCPKG</a></h2>
<p>We will use Chocolatey to install CMake, Ninja and git, which are needed to use VCPKG.</p>
<p>First, head over to <a href="https://chocolatey.org/install#individual">Chocolatey's website</a> and follow their install instructions.</p>
<p>Once Chocolatey is installed, open a fresh elevated prompt and run:</p>
<pre><code>choco install cmake git ninja
</code></pre>
<p>Once the installation is done, navigate to the folder that will host the VCPKG installation and run:</p>
<pre><code>git clone https://github.com/Microsoft/vcpkg.git
cd vcpkg
</code></pre>
<p>Then run the following command to download (or compile) the executable, you can pass the <code>-disableMetrics</code> argument if you wish disable usage metrics:</p>
<pre><code>./bootstrap-vcpkg.bat
</code></pre>
<p>Finally, you want to modify your environment variables and add:</p>
<pre><code>VCPKG_ROOT              C:/Path/To/VCPKG
VCPKG_DEFAULT_TRIPLET   x64-windows
</code></pre>
<p>And update your PATH by adding a new entry containing: <code>%VCPKG_ROOT%</code></p>
<p>NB: VCPKG can be on any drive, not necessarily on the C drive.</p>
<h2 id="installing-libraries-with-vcpkg"><a class="header" href="#installing-libraries-with-vcpkg">Installing libraries with VCPKG</a></h2>
<p>With VCPKG in your path, it is pretty straight forward to install libraries and use them in CMake. As Visual Studio ships by default with both a <code>x64</code> and a <code>x86</code> configuration, we will install both.</p>
<p>Start by running the following command:</p>
<pre><code>vcpkg search sdl2
</code></pre>
<p>This will list all the SDL2 packages and their available &quot;features&quot; in square brackets. For this tutorial, we will stick to the default set of features, but if you need more, simply append the list of features after the name. For example, <code>&quot;sdl2-image[libjpeg-turbo,libwebp]&quot;</code> will add jpeg and webp support to SDL2_image.</p>
<p>Run the following commands to install all the packages for both x86 and x64:</p>
<pre><code>vcpkg instal --triplet=x86-windows sdl2 sdl2-image sdl2-mixer sdl2-net sdl2-ttf
vcpkg instal --triplet=x64-windows sdl2 sdl2-image sdl2-mixer sdl2-net sdl2-ttf
</code></pre>
<p>Finally, run this command:</p>
<pre><code>vcpkg integrate install
</code></pre>
<h2 id="creating-the-project"><a class="header" href="#creating-the-project">Creating the project</a></h2>
<p>Start by creating a new project with the template <code>CMake Project</code>. Give it a name and leave <code>Place solution and project in the same directory</code> ticked on.</p>
<p>Before generating the cache, you want to head over into <code>CMakePresets.json</code>, and in the <code>windows-base</code> preset add the following block inside <code>&quot;cacheVariables&quot;</code>:</p>
<pre><code class="language-json">&quot;CMAKE_TOOLCHAIN_FILE&quot;: {
  &quot;value&quot;: &quot;$env{VCPKG_ROOT}/scripts/buildsystems/vcpkg.cmake&quot;,
  &quot;type&quot;: &quot;FILEPATH&quot;
}
</code></pre>
<p>If the cache was generated beforehand, you may need to delete the <code>out</code> directory for the toolchain file to be taken into account.</p>
<p>Next, in the <code>CMakeLists.txt</code> you want to add the following lines before the <code>add_executable</code> statement:</p>
<pre><code class="language-cmake">find_package(SDL2 CONFIG REQUIRED)
find_package(sdl2-image CONFIG REQUIRED)
find_package(sdl2-mixer CONFIG REQUIRED)
find_package(sdl2-net CONFIG REQUIRED)
find_package(sdl2-ttf CONFIG REQUIRED)
</code></pre>
<p>This will instruct CMake to search for all the SDL2 libraries, and that they are required (configuration should fail if they are not found).</p>
<p>After the <code>add_executable</code> statement, you want to add the following lines:</p>
<pre><code class="language-cmake">target_link_libraries(
  CMakeTarget
  PRIVATE
  SDL2::SDL2
  SDL2::SDL2main
  SDL2::SDL2_image
  SDL2::SDL2_mixer
  SDL2::SDL2_net
  SDL2::SDL2_ttf)
</code></pre>
<p>This will tell CMake to link all the libraries to your application.</p>
<p>Your <code>CMakeLists.txt</code> should now look like this:</p>
<pre><code class="language-cmake">cmake_minimum_required (VERSION 3.8)

project (&quot;SDL CMake Tutorial&quot;)

find_package(SDL2 CONFIG REQUIRED)
find_package(sdl2-image CONFIG REQUIRED)
find_package(sdl2-mixer CONFIG REQUIRED)
find_package(sdl2-net CONFIG REQUIRED)
find_package(sdl2-ttf CONFIG REQUIRED)

# Add source to this project's executable.
add_executable (CMakeTarget &quot;SDL CMake Tutorial.cpp&quot; &quot;SDL CMake Tutorial.h&quot;)

target_link_libraries(
  CMakeTarget
  PRIVATE
  SDL2::SDL2
  SDL2::SDL2main
  SDL2::SDL2_image
  SDL2::SDL2_mixer
  SDL2::SDL2_net
  SDL2::SDL2_ttf)
</code></pre>
<p>Lastly, we will replace the content of your cpp file to initialize all the libraries, print out their version and shut them all down, ensuring everything worked correctly.</p>
<details>
<summary> Test code </summary>
<pre><code class="language-cpp">#include &lt;SDL.h&gt;
#include &lt;SDL_image.h&gt;
#include &lt;SDL_mixer.h&gt;
#include &lt;SDL_net.h&gt;
#include &lt;SDL_ttf.h&gt;

/**
 * @brief Initializes every library.
 */
void init_all(void) {
  if (0 &gt; SDL_Init(SDL_INIT_VIDEO)) {
    SDL_Log(&quot;%s\n&quot;, SDL_GetError());
    return;
  }

  if (0 &gt; IMG_Init(IMG_INIT_PNG)) {
    SDL_Log(&quot;%s\n&quot;, IMG_GetError());
    return;
  }

  if (0 &gt; Mix_Init(MIX_INIT_MP3)) {
    SDL_Log(&quot;%s\n&quot;, Mix_GetError());
    return;
  }

  if (0 &gt; SDLNet_Init()) {
    SDL_Log(&quot;%s\n&quot;, SDLNet_GetError());
    return;
  }

  if (0 &gt; TTF_Init()) {
    SDL_Log(&quot;%s&quot;, TTF_GetError());
    return;
  }

  SDL_Log(&quot;Every library was initialized successfully.\n&quot;);
}

/**
 * @brief Quits all libraries.
 */
void quit_all(void) {
  TTF_Quit();
  SDLNet_Quit();
  Mix_Quit();
  IMG_Quit();
  SDL_Quit();
}

/**
 * @brief For each libraries, logs the installed version.
 */
void log_libraries_version(void) {
  SDL_version sdl_compiled_version;
  SDL_VERSION(&amp;sdl_compiled_version);
  SDL_version sdl_linked_version;
  SDL_GetVersion(&amp;sdl_linked_version);
  SDL_Log(&quot;SDL:\n&quot;
          &quot;\tCompiled against: %d.%d.%d\n&quot;
          &quot;\tLinked against: %d.%d.%d\n&quot;,
          sdl_compiled_version.major, sdl_compiled_version.minor,
          sdl_compiled_version.patch, sdl_linked_version.major,
          sdl_linked_version.minor, sdl_linked_version.patch);

  SDL_version img_compiled_version;
  SDL_IMAGE_VERSION(&amp;img_compiled_version);
  const SDL_version *img_linked_version = IMG_Linked_Version();
  SDL_Log(&quot;SDL Image:\n&quot;
          &quot;\tCompiled against: %d.%d.%d\n&quot;
          &quot;\tLinked against: %d.%d.%d\n&quot;,
          img_compiled_version.major, img_compiled_version.minor,
          img_compiled_version.patch, img_linked_version-&gt;major,
          img_linked_version-&gt;minor, img_linked_version-&gt;patch);

  SDL_version mix_compiled_version;
  SDL_MIXER_VERSION(&amp;mix_compiled_version);
  const SDL_version *mix_linked_version = Mix_Linked_Version();
  SDL_Log(&quot;SDL Mixer:\n&quot;
          &quot;\tCompiled against: %d.%d.%d\n&quot;
          &quot;\tLinked against: %d.%d.%d\n&quot;,
          mix_compiled_version.major, mix_compiled_version.minor,
          mix_compiled_version.patch, mix_linked_version-&gt;major,
          mix_linked_version-&gt;minor, mix_linked_version-&gt;patch);

  SDLNet_version net_compiled_version;
  SDL_NET_VERSION(&amp;net_compiled_version);
  const SDLNet_version *net_linked_version = SDLNet_Linked_Version();
  SDL_Log(&quot;SDL Net:\n&quot;
          &quot;\tCompiled against: %d.%d.%d\n&quot;
          &quot;\tLinked against: %d.%d.%d\n&quot;,
          net_compiled_version.major, net_compiled_version.minor,
          net_compiled_version.patch, net_linked_version-&gt;major,
          net_linked_version-&gt;minor, net_linked_version-&gt;patch);

  SDL_version ttf_compiled_version;
  TTF_VERSION(&amp;ttf_compiled_version);
  const SDL_version *ttf_linked_version = TTF_Linked_Version();
  SDL_Log(&quot;SDL TTF:\n&quot;
          &quot;\tCompiled against: %d.%d.%d\n&quot;
          &quot;\tLinked against: %d.%d.%d\n&quot;,
          ttf_compiled_version.major, ttf_compiled_version.minor,
          ttf_compiled_version.patch, ttf_linked_version-&gt;major,
          ttf_linked_version-&gt;minor, ttf_linked_version-&gt;patch);
}

int main(int, char **) {
  init_all();
  log_libraries_version();
  quit_all();
}
</code></pre>
</details>
<p>After pasting the code and saving the file, press F5 to run the executable, if no error shows up: congratulations, you are ready to get coding!</p>
<h2 id="notes-about-sdl2main"><a class="header" href="#notes-about-sdl2main">Notes about SDL2main</a></h2>
<p>When coding an app, you may not care about arguments passed through command line, and may as such be tempted to change your entry point to:</p>
<pre><code class="language-cpp">int main()
</code></pre>
<p>This declaration is unfortunately incompatible with the way SDL2main works. If you do not care about arguments, and have warnings turned on for unused variables, you have two ways to ignore them:</p>
<pre><code class="language-cpp">int main(int, char **) { // C++-only
  // Your code
}

int main(int argc, char *argv[]) { // C/C++
  (void)argc;
  (void)argv;
  // Your code
}
</code></pre>
<p>The first option consists in telling the compiler: &quot;Yes, there are two arguments of these types in my signature, but I will not use them, and as such did not give them a name.” The second option is to add a no-op statement for each argument, so they are considered &quot;used&quot; despite not doing anything.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../ch2-visual-studio/4-msbuild-vcpkg.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../ch2-visual-studio/4-msbuild-vcpkg.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
